<!DOCTYPE html>
<html >
<head>
  <meta charset="UTF-8">
  <title>Pure CSS 3D Piano octave</title>



      <link rel="stylesheet" href="css/style.css">

      <!-- Include Leapstrap CSS -->
      <link rel="stylesheet" href="//wilkesalex.github.io/leapstrap/dist/css/leapstrap.css" />
      
</head>

<body>
  <!-- <div>
    <button type="button" class="button top" onclick="turn('top')"></button>
  </div> -->

<div>
  <!-- <button type="button" class="button left" onclick="turn('left')"></button> -->
    <section class="piano" id="piano">
      <button type="button" tabindex="-1" class="key-12" onclick="playAudio('b')" title="B"></button>
      <button type="button" tabindex="-1" class="key-1" onclick="playAudio('c')" title="C"></button>
      <button type="button" tabindex="-1" class="key-2" onclick="playAudio('db')" title="C#/Db"></button>
      <button type="button" tabindex="-1" class="key-3" onclick="playAudio('d')" title="D"></button>
      <button type="button" tabindex="-1" class="key-4" onclick="playAudio('eb')" title="D#/Eb"></button>
      <button type="button" tabindex="-1" class="key-5" onclick="playAudio('e')" title="E"></button>
      <button type="button" tabindex="-1" class="key-6" onclick="playAudio('f')" title="F"></button>
      <button type="button" tabindex="-1" class="key-7" onclick="playAudio('gb')" title="F#/Gb"></button>
      <button type="button" tabindex="-1" class="key-8" onclick="playAudio('g')" title="G"></button>
      <button type="button" tabindex="-1" class="key-9" onclick="playAudio('ab')" title="G#/Ab"></button>
      <button type="button" tabindex="-1" class="key-10" onclick="playAudio('a')" title="A"></button>
      <button type="button" tabindex="-1" class="key-11" onclick="playAudio('bb')" title="A#/Bb"></button>
      <button type="button" tabindex="-1" class="key-12" onclick="playAudio('b')" title="B"></button>
      <button type="button" tabindex="-1" class="key-1" onclick="playAudio('c')" title="C"></button>
    </section>
    <!-- <button type="button" class="button right" onclick="turn('right')"></button> -->
  </div>

  <!-- <div>
    <button type="button" class="button bottom" onclick="turn('bottom')"></button>
  </div> -->

<p class="firefox">
  Firefox is pretty bad at displaying complex 3D styles. I have managed to make sort of acceptable version for the actual project I used it in, you can visit <a href="http://waterplea.com/chant/">waterplea.com/chant</a> to check it out (click on piano button on top right) or for the smoothest experience use Chrome. I don't feel like tweaking this pen for Firefox specifically.
</p>

<p class="ie">No IE support, sorry. Try using Chrome.</p>

<script  src="js/index.js"></script>



<!-- Canvas for finger overlay -->

<canvas id="leap-overlay"></canvas>
<script src="//js.leapmotion.com/0.2.0-beta1/leap.min.js"></script>

<script>
var canvas = document.getElementById("leap-overlay");

// fullscreen
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

// create a rendering context
var ctx = canvas.getContext("2d");
ctx.translate(canvas.width/2,canvas.height);
ctx.fillStyle = "rgba(0,0,0,0.7)";

// render each frame
function draw(obj) {
  // clear last frame
  ctx.clearRect(-canvas.width/2,-canvas.height,canvas.width,canvas.height);

  // render circles based on pointable positions
  var pointablesMap = obj.pointablesMap;
  for (var i in pointablesMap) {
    // get the pointable's position
    var pointable = pointablesMap[i];
    var pos = pointable.tipPosition;

    // create a circle for each pointable
    var radius = Math.min(600/Math.abs(pos[2]),20);
    ctx.beginPath();
    ctx.arc(pos[0]-radius/2,-pos[1]-radius/2,radius,0,2*Math.PI);
    ctx.fill();
  }
};

// listen to Leap Motion
Leap.loop(draw);

var controller = Leap.loop({enableGestures: true}, function(frame){
  if(frame.valid && frame.gestures.length > 0){
    frame.gestures.forEach(function(gesture){
        if (gesture.type == "keyTap"){
               var position = gesture.position;
               if(frame.pointables.length > 0)
                {
                    //canvas.width = canvas.width; //clear

                    //Get a pointable and normalize the tip position
                    var pointable = frame.pointables[0];
                    var interactionBox = frame.interactionBox;
                    console.log(pointable.tipPosition);
                    var normalizedPosition = interactionBox.normalizePoint(pointable.tipPosition, true);

                    // Convert the normalized coordinates to span the canvas
                    var canvasX = canvas.width * normalizedPosition[0];
                    var canvasY = canvas.height * (1 - normalizedPosition[1]);
                    //we can ignore z for a 2D context

                    //displayArea.strokeText("(" + canvasX.toFixed(1) + ", " + canvasY.toFixed(1) + ")", canvasX, canvasY);
                    console.log(canvasX +" " +canvasY);
                }
              console.log("Key Tap Gesture");
        }
    });
  }
});
</script>
<style>
html, body { width: 100%; height: 100%; margin: 0; padding: 0}
#leap-overlay { position: fixed; top: 0; left: 0;}
</style>

</body>
</html>
